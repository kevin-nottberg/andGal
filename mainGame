package android.andGal.mainGame;

public class AndroidGal extends Activity implements onTouchListener
{
    AssetManager fdman;
    Bitmap bitMap;
    RenderView renView;
    int BLUE = 1;
    int YELLOW = 2;
    int RED = 3;
    int GREEN = 4;
    
    public void onCreate( Bundle savedInstanceState )
    {
        super.onCreate( savedInstanceState );
        
        requestWindowFeature( Window.FEATURE_NO_TITLE );
    	getWindow().setFlags( WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN );
        
        renView = new RenderView( this );
        renView.setOnTouchListener( this );
        setContentView( renView );
        
    }
    
    public boolean onTouch( View v, MotionEvent event )
    {
		// Initilizing some varibles for multi-touch
		int halfHeight = renderView.getHeight() / 2;
		int maxCount = event.getPointerCount();
		int action = MotionEventCompat.getActionMasked( event );
		Log.d("KevinApp", "OnTouch: " + String.valueOf( action ));
		for ( int i = 0; i < maxCount; i++ )
		{
			// int mActivePointerId = event.getPointerId( i );
			// int pointerIndex = event.findPointerIndex( mActivePointerId );
			// int index = MotionEventCompat.getActionIndex( event );
   
			// Reacting to the finger taps
			switch( action )
			{
				case MotionEvent.ACTION_DOWN:
				case MotionEvent.ACTION_POINTER_DOWN:
				case MotionEvent.ACTION_MOVE:
					if ( MotionEventCompat.getY( event, i ) < halfHeight )
					{
						curPointPosXtwo = (int) MotionEventCompat.getX( event, i );
						// curPointPosYtwo = (int) MotionEventCompat.getY( event, i );
					}
					if ( MotionEventCompat.getY( event, i ) > halfHeight )
					{
						curPointPosXone = (int) MotionEventCompat.getX( event, i );
						// curPointPosYone = (int) MotionEventCompat.getY( event, i );
					}
			break;
			}
		}	
		return true;
	}
    
    public void onResume()
    {
        super.onResume();
        renView.resume();
    }
    
    public void onPause()
    {
        super.onPause();
        renView.pause();
    }
    
    public class RenderView extends SurfaceView implements Runnable
    {
        Thread renThread;
        SurfaceHolder holder;
        volatile boolean running = false;
        Paint paint;
        
        public RenderView( Context context )
        {   
            super( context );
            holder = getHolder();
            paint = new Paint();
        }
        
        public void resume()
        {
        	renThread = new Thread( this );
        	running = true;
        	renThread.start();
        }
        
        public void pause() 
		{
			Log.d("KevinMess", "renderPause");
			running = false;
			while( true )
			{
				try {
					renThread.join();
					return;
				} catch ( InterruptedException e ) {
					//retry
				}
			}
		}
        
        public void run()
        {
        	long startTime = System.nanoTime();
        	
        	while( running )
        	{
        		deltaTime = ( System.nanoTime - startTime ) * 1000000000.0f
        		
        		if ( !holder.getSurface().isValid() )
        			continue;
        			
        		Canvas canvas = holder.lockCanvas();
        		canvas.drawRGB( 0, 0, 0 );
        		paint.setStyle( Style.FILL );
        		int width = canvas.getWidth();
        		int height = canvas.getHeight();
        	
        		canvas.unlockCanvasAndPost( canvas );
        	}
        }
    }
    
    public class KillingMachine
    {
    	public KillingMachine()
    	{
    		
    	}
    	
    	public void shoot()
    	{
    	
    	}
    	
    	public void update()
    	{
    	
    	}
    	
    	public void collisionCheck()
    	{
    	
    	}
    }
    
    public class SpaceShip
    {
 		private int clipStat;
 		private int Color; 
		private int reloadLoop;
		private int bulletRX;
		private int bulletTY;
		private int bulletLX;
		private int bulletBY;
 	
    	public SpaceShip()
    	{
    		clipStat = 6;
    		reloadLoop = 0;
    		Color = 0;
    	}
    	
    	public void shoot()
    	{
    		if ( clipStat == 6 )
    		{
    			clipStat = 5;
    		}
    		
    		if ( clipStat == 5 )
    		{
    			clipStat = 4;
    		}
    		
    		if ( clipStat == 4 )
    		{
    			clipStat = 3;
    		}
    		
    		if ( clipStat == 3 )
    		{
    			clipStat = 2;
    		}
    		
    		if ( clipStat == 2 )
    		{
    			clipStat = 1;
    		}
    		
    		if ( clipStat == 1 )
    		{
    			clipStat = 0;
    		}
    		
    		if ( clipStat == 0 )
    		{
    			reloadLoop++;
    		}
    		
  			if ( clipStat == 0 && reloadLoop == 1 )
  			{
  				reloadLoop = 0;
  				clipStat == 6;
  			}
    	}
    	
    	public void getBitmap( int shipCol )
    	{
    		if ( shipCol == BLUE )
    		{
    			Color = BLUE;
    			// return bitMap address of the blue spaceship
    		}
    		
    		if ( shipCol == YELLOW )
    		{
    			Color = YELLOW;
    			// return bitMap address of the yellow spaceship
    		}
    		
    		if ( shipCol == RED )
    		{
    			Color = RED;
    			// return bitMap address of the red spaceship
    		}
    		
    		if ( shipCol == GREEN )
    		{
    			Color = GREEN;
    			// return bitmap address of the green spaceship
    		}
    	}
    }
    
    public class Pixmap
    {
    	Bitmap bitmap;
    	PixmapFormat format;
    	
    	public Pixmap( Bitmap bitmap, PixmapFormat format )
    	{
    		this.bitmap = bitmap;
    		this.format = format;
    	}
    	
    	public int getWidth()
    	{
    		return bitmap.getWidth();
    	}
    	
    	public int getHeight()
    	{
    		return bitmap.getHeight();
    	}
    	
    	public PixmapFormat getFormat()
    	{
    		return format;
    	}
    	
    	public void dispose()
    	{
    		bitmap.recycle();
    	}
    }
    
    public class Graphics()
    {
    	AssetManager assets;
    	Bitmap frameBuffer;
    	Rect srcRect = new Rect();
    	Rect dstRect = new Rect();
    	
    	public Graphics( AssetManager assets, Bitmap frameBuffer )
    	{
    		this.assets = assets;
    		this.frameBuffer = frameBuffer;
    	}
    	
    	public Pixmap newPixmap( String fileName, PixmapFormat format )
    	{
    		Config config = null;
    		if ( format == PixmapFormat.RGB565 )
    			config = Config.RGB_565;
    		else if ( format == PixmapFormat.ARGB4444 )
    			config = Config.ARBG_4444;
    		else 
    			config = Config.ARGB_8888;
    		
    		Options options = new Options();
    		options.inPrefferdConfig = config;
    		
    		InputStream in = null;
    		Bitmap bitmap = null;
    		try {
    			in = assets.open( fileName);
    			bitmap = BitmapFactory.decodeStream( in );
    			if ( bitmap == null )
 					thrown new RunTimeException( " " );
 			} catch ( IOExceptions e ) {
 				thrown new RunTimeException( " " );
 			} finally {
 				if ( in != null )
 				{
 					try {
 						in.close();
 					} catch (IOException e ) {
 					}
 				}	
    		}
    	}
	}
